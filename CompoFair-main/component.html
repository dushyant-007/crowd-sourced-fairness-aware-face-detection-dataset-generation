<!-- You must include this JavaScript file -->
<script src="https://assets.crowd.aws/crowd-html-elements.js"></script>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-uWxY/CJNBR+1zjPWmfnSnVxwRheevXITnMqoEIeG1LJrdI0GlVs/9cVSyPYXdcSF" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-kQtW33rZJAHjgefvhyyzcGF3C5TFyBQBA13V1RKPf4uH+bwyzQxZ6CmMZHmNBEfJ" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<style type="text/css">
.large-img {
    height: 200px;
    width: 200px;
}
</style>
<div class="container">
    <div class="alert alert-success" role="alert">
        <h4 class="alert-heading">Instruction</h4>
        <p>Welcome! Everyone knows how a human looks like, right:)?</p>
        <p>There are three human face images below. The faces are from different persons.</p>
        <p>Your task is to select two images that you feel are more similar compared to the other image.</p>
        <p>Your selection should be based on one or more <b>face components</b> that are given as options below.</p>
        <p>You need to add <b>only one</b> adjective word as the <b>descriptor</b> for the one selected face component.</p>
        <p>male/female/young/old/same/different are not adjective words to describe face components!</p>
        <p style="color:red">Any answer that is not satisfied with our requirements will be rejected and even blocked.</p>
    </div>
    <div class="alert alert-info" role="alert">
        <h4 class="alert-heading">Example</h4>
        <img src="https://res.cloudinary.com/dhortnuos/image/upload/v1651813400/example_tmgbra.png" width="800" height="500">
    </div>
    <hr>
    <crowd-form answer-format="flatten-objects" id="form1">
        <div class="row" id="row0">
            <div class="col-sm-4" id="col0"></div>
            <div class="col-sm-4" id="col1"></div>
            <div class="col-sm-4" id="col2"></div>
        </div>
        <div class="row" id="row1">
            <p>
            I feel image 
            <select name="a1" style="display: inline-block;">
                <option value='0' selected>selection</option>
                <option value='1'>1)</option>
                <option value='2'>2)</option>
                <option value='3'>3)</option>
            </select> and image
            <select name="a2" style="display: inline-block;">
                <option value='0' selected>selection</option>
                <option value='1'>1)</option>
                <option value='2'>2)</option>
                <option value='3'>3)</option>
            </select> are more similar, because they both have
            <input type="text" name="d1" placeholder="only one adjective word">
            <select name="compo" style="display: inline-block;">
                <option value='0' selected>selection</option>
                <option value='1'>Forehead</option>
                <option value='2'>Eyebrow</option>
                <option value='3'>Eye</option>
                <option value='4'>Mouth</option>
                <option value='5'>Chin</option>
                <option value='6'>Cheek</option>
                <option value='7'>Nose</option>
                <option value='8'>Ear</option>
                <option value='9'>Temple</option>
                <option value='10'>Nostril</option>
                <option value='11'>Tooth</option>
                <option value='12'>Lip</option>
                <option value='13'>Tongue</option>
                <option value='14'>Skin</option>
            </select> while the same component of the other image is
            <input type="text" name="d2" placeholder="only one adjective word">.
        </p>
        </div>
        <hr>
        <div class="input-group mb-3">
            <div class="input-group-prepend">
                <span class="input-group-text" id="ver_q">Verification: </span>
            </div>
            <input type="text" class="form-control" aria-label="Username" aria-describedby="basic-addon1" name="answer" id="ver_a">
        </div>
        <div class="input-group mb-3">
            <div class="input-group-prepend">
                <span class="input-group-text">Your comment:</span>
            </div>
            <input type="text" class="form-control" placeholder="Optional" aria-label="Username" aria-describedby="basic-addon1" name="comment" id="comment">
        </div>
    </crowd-form>
</div>
<script type="text/javascript">
function getRandomInt(min, max) {
    min = Math.ceil(min);
    max = Math.floor(max);
    return Math.floor(Math.random() * (max - min + 1)) + min;
}

$(document).ready(function() {
    var img1 = "${img1}";
    var img2 = "${img2}";
    var img3 = "${img3}";

    img1 = "https://celebapool.s3.us-east-2.amazonaws.com/"+img1.split("/").at(-1)
    img2 = "https://celebapool.s3.us-east-2.amazonaws.com/"+img2.split("/").at(-1)
    img3 = "https://celebapool.s3.us-east-2.amazonaws.com/"+img3.split("/").at(-1)

    console.log(img1);

    $("#col0").append("<p>1) <img src='"+img1+"' width='160px' height='200px' style='display: inline-block;'></p>");
    $("#col1").append("<p>2) <img src='"+img2+"' width='160px' height='200px' style='display: inline-block;'></p>");
    $("#col2").append("<p>3) <img src='"+img3+"' width='160px' height='200px' style='display: inline-block;'></p>");

    var question_answer = ["what is the first letter of apple?-a", "what is the result of 3 plus 6?-9", "what is the result of 12 plus 2?-14"];
    var random_idx = getRandomInt(0, 2);
    $("#ver_q").append(question_answer[random_idx].split("-")[0]);

    $("#form1").submit(function(event) {
        var flag = true;
        var alert_text = "";
        $("#form1 select").each(function() {
            var input = $(this);
            if (input.val().trim() == '0') {
                alert_text = 'Please answer every question.';
                flag = false
            }
        });
        $("#form1 input").each(function() {
            var input = $(this);
            if (input.val().trim() == '' && input.attr('name') != 'comment') {
                alert_text = 'Please answer every question.';
                flag = false
            }
            if (input.val().trim().split(" ").length >= 2) {
                alert_text = 'Please only use one adjective word to describe the face component selected in the following part.';
                flag = false
            }
        });
        if ($("#ver_a").val() != question_answer[random_idx].split("-")[1]) {
            alert_text = 'The answer to the verification question is not correct.';
            flag = false;
        }
        if (flag == true) {
            $("#form1").submit();
        } else {
            alert(alert_text);
            event.preventDefault();
        }
    });
});
</script>